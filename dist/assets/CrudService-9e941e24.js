import{e as i}from"./index-254ebb3c.js";class u{constructor(e,t){this.baseUrl="http://localhost:8090"+e,this.toast=t}auth(e,t){let s={username:e,password:t};return this.request("POST",this.baseUrl+"/api/auth",s)}getToken(){let e=JSON.parse(localStorage.getItem("session"));return e?e.token:""}clearSession(){localStorage.removeItem("session")}request(e,t,s=null,r={}){let a={Token:this.getToken()},n=null;s&&(r||(r={}),r["Content-Type"]="application/json",n=JSON.stringify(s));for(let o in Object.keys(r))a[o]=r[o];return fetch(t,{method:e,headers:a,body:n})}response(e){switch(e.status){case 200:return e.json();case 401:this.clearSession(),i.push("login").then(t=>console.log(t.message));break;default:e.text().then(t=>{this.toast.add({severity:"error",summary:"Ошибка",detail:t,life:3e3})});break}return null}read(e){return e&&(this.baseUrl+="/"+e),this.request("GET",this.baseUrl).then(t=>this.response(t))}create(e){return this.request("POST",this.baseUrl,e).then(t=>t.text()).then(t=>t.data)}update(e,t){return e&&(e="?"+e),this.request("PUT",this.baseUrl+e,t).then(s=>s.text()).then(s=>s.data)}delete(e){return e&&(e="/"+e),this.request("DELETE",this.baseUrl+e).then(t=>t.text()).then(t=>t.data)}}export{u as C};
